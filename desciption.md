В данном тестовом задании предлагается решить 3 задачи на Python и 1 задачу на SQL.

Пожалуйста, не используйте аннотации типов в коде на Python.

Пожалуйста, не используйте документирование (строки документации) модулей, классов, методов и функций. Хороший нейминг - это лучшая документация.

Пожалуйста, для каждой задачу на Python оформите модуль, содержащий функции или классы, реализующие логику решения задачи в общем случае. Создайте демонстрационный скрипт, в котором импортируйте нужные функции или классы из соответствующего модуля и используйте их для решения частной задачи.

Пример решения задачи на Python
Задание: Необходимо вывести из конфигурационного файла my.config все строки начинающиеся с префикса URL_. Реализуйте логику через генератор. Предусмотрите возможность игнорирования регистра букв при сопоставлении префикса.

Структура файлов:

./example
./myiter
__init__.py
./data
my.config
./demo.py

Содержание файлов:

./myiter/__init__.py

__all__ = (
    'preflines',
)

def preflines(f, prefix, ignorecase=False):
    if ignorecase:
        prefix = prefix.lower()

    for line in f:
        line = line.rstrip()
        if ignorecase:    
            if line.lower().startswith(prefix):
                yield line
        else:
            if line.startswith(prefix):
                yield line


./demo.py

from myiter import preflines

with open('./data/my.config', 'rt', encoding='utf8') as config:
    for line in preflines(config, 'URL_', ignorecase=True):
        print(line)


./data/my.config

PARAM1 = 123
PARAM2 = 'abc'

URL_TEST1 = 'https://'
URL_TEST2 = 'https://'
url_test3 = 'https://'

USER_ID = 1
USER_URL = 'http://'

Задание 1

Имеются два файла f1.txt и f2.txt:

В файле f1.txt содержатся уникальные строковые идентификаторы, состоящие из латинских символов разной длины, разделенные между собой символом переноса строки.
В файле f2.txt содержатся числовые значения (целочисленные), разделенные между собой символом переноса строки.

Необходимо “объединить” данные файлы в генератор, возвращающий кортежи из двух элементов: строковый идентификатор (из f1.txt) и значение - число (из f2.txt), на соответствующих позициях в файлах. Если строковому идентификатору не хватило числового значения, то значением должно быть None. Числовые значения, которым не хватило строковых идентификаторов, нужно игнорировать.

Пример:

f1.txt:
aa
bbb
c
dddd
f2.txt:
123
321
0


Output:
( "a", 123, )
( "bbb", 321, )
( "c", 0, )
( "dddd", None, )


Задание 2

Решение должно быть в виде SQL-запросов (без Python)!

В базе данных содержатся 3 сущности — users, courses и saves:

users [ id, name ]
courses [ id, name ]
saves [ id, user_id, course_id, lesson_no, exercise_no, data ]

Таблица users содержит информацию о пользователях.
Таблица courses содержит информацию об обучающих курсах.
Таблица saves содержит информацию о результатах 
прохождения различных упражнений пользователями в определенных курсах. 
Каждое упражнение характеризуется 3 атрибутами: 
course_id, lesson_no, exercise_no. 
В каждом уроке каждого курса может быть несколько упражнений. 
Пользователи могут выполнять каждое упражнение в каждом курсе более одного раза. 
В таблице хранится информация обо всех попытках пользователя.

Используя sqlite3 создайте базу данных и соответствующие сущности 
(напишите SQL для создания таблиц). 
Напишите SQL-запрос, результатом которого будет выборка из двух полей: 
"Имя пользователя" и "Количество пройденных курсов". 
Курс считается пройденным, если суммарно по курсу выполнено 100 различных упражнений. 
Факт наличия записи в таблице saves — это показатель, 
что соответствующее упражнение было выполнено пользователем.


Задание 3

Для иностранных клиентов требуется корректировать стоимость продукта (базовая цена в рублях) в зависимости от курса валют на текущий момент времени. По адресу http://www.cbr.ru/scripts/XML_daily.asp находятся актуальные данные ЦБ РФ о курсах валют. Необходимо получить данные по соответствующему url и извлечь курсы доллара и евро по отношению к рублю. Для идентификации валюты использовать символьные коды (USD, EUR) или цифровые коды (840, 978).

Также необходимо предусмотреть кэширование выходных данных, чтобы при многократном обращении за курсом валют, реальный запрос по url делался только с определенной частотой. Кэш должен быть реализован с помощью паттерна делегирования, чтобы сторонний разработчик мог использовать свою реализацию кэша, ничего не меняя в вашем коде. Напиши свой базовый вариант кэша для данной задачи, который будет кэшировать данные на заданный интервал времени.

Формат выходных данных:

{
    'USD': Decimal(59.51),
'EUR': Decimal(63.45)
}

Задание 4

Имеется csv-файл вида (данные не упорядочены):

email,name
test1@mail.ru,username1
test2@gmail.com,username2
test3@gmail.com,username3
test4@rambler.ru,username4
test5@ya.ru,username5
...
testN@yahoo.com,usernameN

Используя данные из csv-файла необходимо создать список чанков, в которых будут содержаться группы кортежей вида (email, username) с условием, что в каждом чанке почтовые домены не должны повторяться (в каждом чанке должно аккумулироваться максимальное число email'ов с уникальными доменами).

Формат выходных данных:

(
    (
        ( ...@mail.ru, username1 ),
        ( ...@gmail.com, username2 ),
        ( ...@rambler.ru, username4 ),
        ( ...@ya.ru, username5 ),
        ...,
        ( ...@yahoo.com, usernameN ),
    ),
    
    (
        ( ...@gmail.com, username3 ),
        ( ...@rambler.ru, ... ),
        ( ...@ya.ru, ... ),
        ...,
    ),

    ...

    (
        ( ...@mail.ru, ... ),
        ( ...@ya.ru, ... ),
    ),
)

